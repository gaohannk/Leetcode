Dept table (id, name, ‍‍‍‌‍‌‍‍‌‌‍‍‌‌‍‌location) and Employee table (id, name, dept_id, salary). Data: Dept table has 5 entries, Employee table has several entries
Inner join to get a report (dept_id, count, sum(salary)) ordered by dept_id. The result should have 4 dept data. The fifth is left out because count=0.
Further questions, 1. print dept_id and dept_name 2. print dept_id even if count=0

select dept_id, count, sum(salary) from employee inner join dept on id ordered by dept_id desc

a. Withdraw or Deposit Money
SELECT D.NAME, IFNULL(DEPOSIT,0), IFNULL(‍‍‍‌‍‌‍‍‌‌‍‍‌‌‍‌-WITHDRAW,0) FROM
    (SELECT T1.NAME, SUM(T1.MONEY) AS DEPOSIT FROM TRANSFERS T1 WHERE T1.MONEY>=0 GROUP BY T1.NAME) D LEFT JOIN
    (SELECT T2.NAME, SUM(T2.MONEY) AS WITHDRAW FROM TRANSFERS T2 WHERE T2.MONEY<=0 GROUP BY T2.NAME) W ON D.NAME = W.NAME
UNION
SELECT W.NAME, IFNULL(DEPOSIT,0), IFNULL(-WITHDRAW,0) FROM
    (SELECT T1.NAME, SUM(T1.MONEY) AS DEPOSIT FROM TRANSFERS T1 WHERE T1.MONEY>=0 GROUP BY T1.NAME) D RIGHT JOIN -baidu 1point3acres
    (SELECT T2.NAME, SUM(T2.MONEY) AS WITHDRAW FROM TRANSFERS T2 WHERE T2.MONEY<=0 GROUP BY T2.NAME) W ON D.NAME = W.NAME . 1point3acres
ORDER BY NAME;

b. Team Score
SELECT TEAM_ID, TEAM_NAME, IFNULL(SUM(M.SCORE),0) AS NUM_POINTS
FROM TEAMS T LEFT JOIN
(
    SELECT * FROM
     (SELECT HOST_TEAM AS TEAM,
         IF(HOST_GOALS>GUEST_GOALS, 3, IF(HOST_GOALS<GUEST_GOALS, 0, 1)) AS SCORE
      FROM MATCHES) H
    UNION ALL
     SELECT * FROM
         (SELECT GUEST_TEAM AS TEAM,
            IF(HOST_GOALS<GUEST_GOALS, 3, IF(HOST_GOALS>GUEST_GOALS, 0, 1)) AS SCORE
         FROM MATCHES) G
) M
ON T.TEAM_ID = M.TEAM
GROUP BY M.TEAM
ORDER BY NUM_POINTS DESC, TEAM_ID;
. 1point3acres
c. Import and Export Company or Country. check 1point3acres for more.
SELECT I.COUNTRY, E.EXPORT, I.IMPORT FROM
(SELECT COUNTRY, IFNULL(SUM(T.VALUE),0) AS IMPORT
FROM COMPANIES C LEFT JOIN TRADES T . From 1point 3acres bbs
ON C.NAME = T.BUYER
GROUP BY COUNTRY) I
INNER JOIN
(SELECT COUNTRY, IFNULL(SUM(T.VALUE),0) AS EXPORT
FROM COMPANIES C LEFT JOIN TRADES T
ON C.NAME = T.SELLER
GROUP BY COUNTRY) E
ON I.COUNTRY = E.COUNTRY
ORDER BY COUNTRY;

d. Bus Passengers on board(答案可能不对，我在MySQL上测试可以，但是其他不行，请注意)
SELECT BB.ID, IFNULL(SUM(C.ON_BOARD),0) PASSENGER_ON_BOARD FROM BUSES BB LEFT JOIN
(SELECT * FROM
(SELECT T.PASSENGER, T.BUS, IF(T.P_TIME<=T.B_TIME,1,0) AS ON_BOARD FROM
(SELECT P.ID AS PASSENGER, B.ID AS BUS, P.TIME AS P_TIME, B.TIME AS B_TIME
FROM PASSENGERS P LEFT JOIN BUSES B
ON P.DESTINATION = B.DESTINATION AND P.ORIGIN = B.ORIGIN) T ORDER BY ON_BOARD DESC, PASSENGER) F
WHERE F.ON_BOARD>0
GROUP BY F.PASSENGER) C
ON C.BUS = BB.ID
GROUP BY C.BUS;

e. Happy Duck
SELECT T.POND_ID, SUM(T.HAPPY_DUCKS) AS HAPPY_DUCKS
FROM
(SELECT F.POND_ID, IF(F.TEMP_PREFERENCES = '+', IF(F.TEMPERATURE>TEMP_LIMIT,1,0), IF(F.TEMPERATURE<TEMP_LIMIT,1,0) ) AS HAPPY_DUCKS
FROM
(SELECT D.ID AS ID, P.ID AS POND_ID, S.ID AS SPECIES_ID, TEMP_PREFERENCES, TEMP_LIMIT, TEMPERATURE
FROM DUCKS D LEFT JOIN PONDS P
ON P.ID = D.POND_ID LEFT JOIN SPECIES S
ON S.ID = D.SPECIES_ID) f
)T
GROUP BY T.POND_ID;

f. Theater tickets
SELECT M.ID, TITLE, IFNULL(SUM(NUMBER_OF_TICKETS),0) AS SOLD_TICKETS FROM
(SELECT * FROM MOVIES) M
LEFT JOIN
(SELECT MOVIE_ID, NUMBER_OF_TICKETS FROM RESERVATIONS) R
ON M.ID=R.MOVIE_ID
GROUP BY TITLE
ORDER BY SOLD_TICKETS DESC;

g. Transfers (转账大于1024的题目). check 1point3acres for more.
SELECT RECIPIENT FROM
(SELECT DISTINCT RECIPIENT FROM TRANSFER2) AS R
WHERE (SELECT SUM(R2.AMOUNT) FROM (SELECT * FROM TRANSFER2 T WHERE T.RECIPIENT = R.RECIPIENT ORDER BY T.AMOUNT DESC LIMIT 3) R2 ) >= 1024
ORDER BY RECIPIENT; -baidu 1point3acres